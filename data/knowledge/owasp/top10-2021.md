# OWASP Top 10 — 2021

## A01:2021 – Broken Access Control
Broken Access Control moves up from the fifth position to the most critical web application security risk. Access control enforces policy such that users cannot act outside of their intended permissions. Failures typically lead to unauthorized information disclosure, modification, or destruction of data, or performing a business function outside the user's limits.

### Common Vulnerabilities
- Violation of the principle of least privilege
- Bypassing access control checks by modifying the URL, internal application state, or HTML page
- Permitting viewing or editing someone else's account by providing its unique identifier (IDOR)
- Accessing API with missing access controls for POST, PUT, and DELETE
- Elevation of privilege by acting as a user without being logged in, or acting as admin when logged in as a user
- CORS misconfiguration allowing access from unauthorized origins

### Prevention
- Deny by default except for public resources
- Implement access control mechanisms once and reuse throughout the application
- Enforce record ownership rather than accepting that the user can create, read, update, or delete any record
- Log access control failures and alert admins
- Rate limit API and controller access
- Invalidate JWT tokens on the server after logout

---

## A02:2021 – Cryptographic Failures
Previously known as "Sensitive Data Exposure," this category focuses on failures related to cryptography which often lead to sensitive data exposure.

### Common Vulnerabilities
- Transmitting data in clear text (HTTP, SMTP, FTP)
- Using old or weak cryptographic algorithms
- Using default crypto keys or weak keys
- Not enforcing encryption via security headers
- Server certificate and trust chain not properly validated
- Passwords stored in plain text or with weak hashing

### Prevention
- Classify data processed, stored, or transmitted and identify sensitive data
- Don't store sensitive data unnecessarily
- Encrypt all sensitive data at rest
- Use up-to-date and strong standard algorithms and protocols
- Encrypt all data in transit with TLS
- Store passwords using strong adaptive hashing functions (bcrypt, scrypt, Argon2)

---

## A03:2021 – Injection
Injection attacks occur when untrusted data is sent to an interpreter as part of a command or query. The attacker's hostile data can trick the interpreter into executing unintended commands or accessing data without proper authorization.

### Common Types
- SQL Injection
- NoSQL Injection
- OS Command Injection
- LDAP Injection
- Expression Language Injection
- OGNL Injection

### Prevention
- Use a safe API which avoids using the interpreter entirely
- Use parameterized queries
- Use positive server-side input validation
- For any residual dynamic queries, escape special characters
- Use LIMIT and other SQL controls within queries to prevent mass disclosure

---

## A07:2021 – Identification and Authentication Failures
Previously known as "Broken Authentication." Confirmation of the user's identity, authentication, and session management is critical to protect against authentication-related attacks.

### Common Vulnerabilities
- Permits automated attacks such as credential stuffing
- Permits brute force or other automated attacks
- Permits default, weak, or well-known passwords
- Uses weak or ineffective credential recovery
- Uses plain text, encrypted, or weakly hashed password data stores
- Missing or ineffective multi-factor authentication
- Exposes session identifier in the URL

### Prevention
- Implement multi-factor authentication
- Do not ship or deploy with any default credentials
- Implement weak password checks
- Limit or increasingly delay failed login attempts
- Use a server-side, secure session manager that generates new random session ID after login
